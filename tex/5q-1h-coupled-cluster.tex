\documentclass[11pt]{article}
\usepackage[cm]{fullpage}
%%AVC PACKAGES
\usepackage{avcgreek}
\usepackage{avcfonts}
\usepackage{avcmath}
\usepackage[numberby=section]{avcthm}
\usepackage{qcmacros}
\usepackage{goldstone}
%%MACROS FOR THIS DOCUMENT
\numberwithin{equation}{section}
\usepackage[
  margin=1.5cm,
  includefoot,
  footskip=30pt,
  headsep=0.2cm,headheight=1.3cm
]{geometry}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{Quiz 5, Handout 1: Coupled-Cluster Theory}
\fancyfoot[CE,CO]{\thepage}
\usepackage{url}
\makeatother
\newcommand{\resolventline}[2][1]{
  \tikz[overlay]{
      \draw[thick,flexdotted] (0,-1ex) to ++(0,#1*4.5ex) node[above,inner sep=1pt] {#2};
  }
}

\begin{document}

\setlength{\abovedisplayskip}{3pt}
\setlength{\belowdisplayskip}{3pt}

\setcounter{section}{4}
\section{Traditional coupled-cluster theory}

\begin{dfn}\label{dfn:cc-effective-hamiltonian}
\thmtitle{Traditional coupled-cluster theory}
A \textit{wave operator} maps a determinant into a correlated wavefunction, $\Y=\W\F$.
The \textit{coupled-cluster Ansatz} is characterized by an exponential parametrization of the wave operator.
\begin{align}
\label{eq:cc-effective-hamiltonian}
  H_\mr{c}\Y_\mr{CC}
=
  E_\mr{c}\Y_\mr{CC}
&&
  \Y_{\mr{CC}}
\equiv
  \mr{exp}(T)
  \F
&&
  T
\equiv
  T_1
+
  T_2
+
  \cd
+
  T_n
&&
  T_k
\equiv
  (\tfr{1}{k!})^2
  t_{a_1\cd a_k}^{i_1\cd i_k}
  \tl{a}^{a_1\cd a_k}_{i_1\cd i_k}
\end{align}
The coupled-cluster Schr\"odinger equation can be projected onto the determinant basis to arrive at a series of equations
\begin{align}
\label{eq:projected-cc-equations}
  \ip{\F|H_\mr{c}|\Y_\mr{CC}}
=
  E_\mr{c}
&&
  \ip{\F_{ij\cd}^{ab\cd}|H_\mr{c}|\Y_\mr{CC}}
=
  E_\mr{c}\,t_{ab\cd}^{ij\cd}
\end{align}
which specify the coupled-cluster energy and the \textit{amplitudes}, $t_{ab\cd}^{ij\cd}$.
A different approach, known as \textit{traditional coupled-cluster (TCC) theory}, first multiplies the Schr\"odinger equation on the left by the inverse of the wave operator
\begin{align}
  \ol{H}_\mr{c}
  \F
=
  E_\mr{c}
  \F
&&
  \ol{H}_\mr{c}
\equiv
  \mr{exp}(-T)
  H_\mr{c}\,
  \mr{exp}(T)
\end{align}
to define an \textit{effective Hamiltonian}, $\ol{H}_\mr{c}$.
The eigenvalue of this similarity-transformed\footnote{See \url{https://en.wikipedia.org/wiki/Matrix_similarity}.} Hamiltonian is the exact correlation energy, $E_\mr{c}$, but its eigenstate is the reference determinant, $\F$, rather than the correlated wavefunction.
Note that, unlike the true Hamiltonian, $\ol{H}_\mr{c}$ is non-Hermitian.
Projection onto the determinant basis yields energy and amplitude equations
\begin{align}
\label{eq:traditional-cc-equations}
  \ip{\F|\ol{H}_\mr{c}|\F}
=
  E_\mr{c}
&&
  \ip{\F_{ij\cd}^{ab\cd}|\ol{H}_\mr{c}|\F}
=
  0
\end{align}
which look similar to equation~\ref{eq:projected-cc-equations}, except that the right-hand side of the amplitude equations is now zero.
The next few results lead up to remark~\ref{rmk:connected-expansion}, which says that the effect of the TCC similarity transformation is to remove disconnected contributions to the amplitude equations, of which $E_\mr{c}t_{ab\cd}^{ij\cd}$ is an example.
\end{dfn}

\begin{ntt}
Nested commutators will here be denoted by
$
  [X,\,\cdot\,]^n(Y)
\equiv
  [X,\cd[X,[X,Y]]\cd]
$
with
$
  [X,\,\cdot\,]^0(Y)
\equiv
  Y
$.
\end{ntt}

\begin{thm}\label{thm:hausdorff}
\thmtitle{The Hausdorff Expansion}
\thmstatement{
$\ds{
  e^{X}Ye^{-X}
=
  \sum_{n=0}^\infty
  \fr{1}{n!}
  [X,\,\cdot\,]^n(Y)
}$
}\vspace{5pt}
\thmproof{
This follows from a direct Taylor expansion of the exponentials, along with proposition~\ref{prop:nested-commutator}.\footnote{For a slick alternative to this proof, see Helgaker, J\o rgensen, and Olsen, \textit{Molecular Electronic-Structure Theory} (2000), p.~100.}
\begin{align*}
  e^XYe^{-X}
=
  \sum_{h=0}^\infty
  \sum_{k=0}^\infty
  \fr{1}{h!\,k!}
  (-)^k
  X^hYX^k
=
  \sum_{n=0}^\infty
  \fr{1}{n!}
  \sum_{k=0}^n
  \fr{n!}{(n-k)!\,k!}
  (-)^k
  X^{n-k}
  Y
  X^k
=
  \sum_{n=0}^\infty
  \fr{1}{n!}
  [X,\,\cdot\,](Y)
\end{align*}
In the second step, we have rearranged the sum to run over $n=h+k$ and $k$ and inserted
$
  1
=
  n!/n!
$.
}
\end{thm}

\begin{prop}\label{prop:wicks-theorem-for-commutators}
\thmstatement{
If $Q$ or $Q'$ contains an even number of operators,
$
  [\gno{Q},\gno{Q'}]
=
  \gno{
    \ctr{}{Q}{}{Q}
    QQ'
  }
-
  \gno{
    \ctr{}{Q}{'}{Q}
    Q'Q
  }
$.
}\vspace{5pt}
\thmproof{
By Wick's theorem,
$
  \gno{Q}\gno{Q'}
-
  \gno{Q'}\gno{Q}
=
  \gno{QQ'}
+
  \gno{
    \ctr{}{Q}{}{Q}
    QQ'
  }
-
  \gno{Q'Q}
-
  \gno{
    \ctr{}{Q}{'}{Q}
    Q'Q
  }
$.
The proposition follows from the fact that, if one of these strings contains an even number of operators, then
$
  \gno{QQ'}
=
  \gno{Q'Q}
$.
}
\end{prop}


\begin{rmk}\label{rmk:connected-expansion}
The Hausdorff expansion can be used to express the TCC effective Hamiltonian in powers of $T$.\footnote{Note that $[X,\,\cdot\,]^n(Y)=[\,\cdot\,,-X]^n(Y)$.}
\begin{align*}
  \ol{H}_\mr{c}
=
  e^{-T}
  H_\mr{c}\,
  e^T
=
  H_\mr{c}
+
  [H_\mr{c}, T]
+
  \tfr{1}{2!}
  [[H_\mr{c}, T], T]
+
  \tfr{1}{3!}
  [[[H_\mr{c}, T], T], T]
+
  \cd
\end{align*}
Proposition~\ref{prop:wicks-theorem-for-commutators} implies that
$
  [H_\mr{c},T]
=
\gno{
  \ctr{}{H}{_\mr{c}}{T}
  H_\mr{c}T
}
$
and more generally
$
  [\,\cdot\,,T]^n(H_\mr{c})
=
\gno{
  \ctr[1.4]{}{H}{_\mr{c}TT\cd}{T}
  \ctr[0.7]{}{H}{_\mr{c}T}{T}
  \ctr[0.0]{}{H}{_\mr{c}}{T}
  H_\mr{c}TT\cd T
}
$,
since
$T$
has no non-vanishing contractions with operators to its right.\footnote{This is easily seen from the diagram.  It comes from the fact that $T$ is composed entirely of quasi-particle creation operators.}
This leads to a new expression for the effective Hamiltonian.\footnote{Subscript C denotes the connected part, i.e.~the connected graphs in a term's Wick expansion.}
\begin{align*}
  \ol{H}_\mr{c}
=
  H_\mr{c}
+
\gno{
  \ctr[0.0]{}{H}{_\mr{c}}{T}
  H_\mr{c}T
}
+
  \tfr{1}{2!}
\gno{
  \ctr[0.7]{}{H}{_\mr{c}T}{T}
  \ctr[0.0]{}{H}{_\mr{c}}{T}
  H_\mr{c}TT
}
+
  \tfr{1}{3!}
\gno{
  \ctr[1.4]{}{H}{_\mr{c}TT}{T}
  \ctr[0.7]{}{H}{_\mr{c}T}{T}
  \ctr[0.0]{}{H}{_\mr{c}}{T}
  H_\mr{c}TTT
}
+
  \tfr{1}{4!}
\gno{
  \ctr[2.1]{}{H}{_\mr{c}TTT}{T}
  \ctr[1.4]{}{H}{_\mr{c}TT}{T}
  \ctr[0.7]{}{H}{_\mr{c}T}{T}
  \ctr[0.0]{}{H}{_\mr{c}}{T}
  H_\mr{c}TTTT
}
=
  (H_\mr{c}\,e^{T})_{\mr{C}}
\end{align*}
This expansion naturally truncates at the fourth power, since each $T$ must have at least one contraction with the Hamiltonian and the electron repulsion operator only has four operators available for contraction.
Substituting this result into equation \ref{eq:traditional-cc-equations} leads to a new expression for the TCC energy and amplitude equations.
\begin{align}
\label{eq:traditional-cc-equations-2}
  \ip{\F|H_\mr{c}\,\mr{exp}(T)|\F}_\mr{C}
=
  E_\mr{c}
&&
  \ip{\F_{ij\cd}^{ab\cd}|H_\mr{c}\,\mr{exp}(T)|\F}_\mr{C}
=
  0
\end{align}
Note that the subscript C here means specifically that that the cluster operators are connected to the Hamiltonian.
Connection through the bare excitation operator $\tl{a}_{ab\cd}^{ij\cd}$ is excluded.
\end{rmk}

\begin{rmk}
It can be shown that the determinant basis forms an eigenbasis for the diagonal part of the Fock operator.\footnotemark
\begin{align}
  H_0\F_{i_1\cd i_k}^{a_1\cd a_k}
=
  \mc{E}_{i_1\cd i_k}^{a_1\cd a_k}
  \F_{i_1\cd i_k}^{a_1\cd a_k}
&&
  H_0
\equiv
  f_p^p\tl{a}^p_p
&&
  \mc{E}_{q_1\cd q_k}^{p_1\cd p_k}
\equiv
  \sum_{r=1}^k
  f_{p_r}^{p_r}
-
  \sum_{r=1}^k
  f_{q_r}^{q_r}
\end{align}
Noting that $H_0$ is Hermitian, this implies $\ip{\F_{ij\cd}^{ab\cd}|H_0\,\mr{exp}(T)|\F}=\mc{E}_{ij\cd}^{ab\cd}\ip{\F_{ij\cd}^{ab\cd}|\mr{exp}(T)|\F}=\mc{E}_{ij\cd}^{ab\cd}t_{ab\cd}^{ij\cd}$.
This can be used to rearrange the amplitude equation in (\ref{eq:traditional-cc-equations-2}) as follows, which defines the working equations used to iteratively solve TCC.
\begin{align}
  t_{ab\cd}^{ij\cd}
=
  (\mc{E}_{ab\cd}^{ij\cd})^{-1}
  \ip{\F_{ab\cd}^{ij\cd}|V_\mr{c}\,\mr{exp}(T)|\F}_\mr{C}
&&
  V_\mr{c}
\equiv
  H_\mr{c}
-
  H_0
=
  f_p^q(1-\d_p^q)
  \tl{a}^p_q
+
  \tfr{1}{4}
  \ol{g}_{pq}^{rs}
  \tl{a}^{pq}_{rs}
\end{align}
In M\o ller-Plesset perturbation theory, $H_0$ is known the \textit{zeroth order Hamiltonian} and $V_\mr{c}$ is the \textit{perturbation}.
These operators are also known as the \textit{model Hamiltonian} and \textit{fluctuation potential}, respectively.
\end{rmk}
\footnotetext{
The proof is as follows.
First, note that $a^p_p\F_\mu = n_p^\mu \F_\mu$, where $n_p^\mu$ is the occupation of $\y_p$ in $\F_\mu$.
By Wick's theorem, $a^p_p=\tl{a}^p_p+n_p^{\mr{ref}}$, where $n_p^{\mr{ref}}$ denotes the occupation of $\y_p$ in $\F$.
Therefore, $\tl{a}^p_p\F_\mu = (n_p^\mu - n_p^{\mr{ref}})\F_\mu$ and $H_0\F_\mu = \pr{\sum_{p\in\F_\mu}f_p^p - \sum_{p\in\F}f_p^p}\F_\mu$.
}

\begin{ntt}
The following is suggested notation for the diagonal and off-diagonal contributions to the Fock operator.
\begin{align}
\diagram{
  \draw (-0.5,0) node[circlex] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
}
=
\diagram{
  \draw (-0.5,0) node[circlez] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
}
+
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
}
&&
\diagram{
  \draw (-0.5,0) node[circlez] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
}
\equiv
  H_0
&&
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
}
\equiv
  f_p^q(1-\d_p^q)
  \tl{a}^p_q
\end{align}
so that
$
  H_e
=
  E_0
+
\diagram{
  \draw (-0.5,0) node[circlez] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.35);
  \draw[-<-] (h1) to ++(0,-0.35);
}
+
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.35);
  \draw[-<-] (h1) to ++(0,-0.35);
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot=white}{sawtooth};
  \draw[->-] (g1) to ++(0,+0.35);
  \draw[-<-] (g1) to ++(0,-0.35);
  \draw[->-] (g2) to ++(0,+0.35);
  \draw[-<-] (g2) to ++(0,-0.35);
}
$
is the full electronic Hamiltonian
and
$
  V_\mr{c}
=
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.35);
  \draw[-<-] (h1) to ++(0,-0.35);
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot=white}{sawtooth};
  \draw[->-] (g1) to ++(0,+0.35);
  \draw[-<-] (g1) to ++(0,-0.35);
  \draw[->-] (g2) to ++(0,+0.35);
  \draw[-<-] (g2) to ++(0,-0.35);
}
$.
\end{ntt}

\begin{dfn}
\thmtitle{Excitation level}
The \textit{excitation level} of a graph equals the net number of particles or quasi-particles it creates, divided by two.
For example, the quasi-particle excitation levels of the $T_1$, $T_2$ and $T_3$ operators are $1$, $2$, and $3$, respectively, and that of $\tl{a}_{abcd}^{ijkl}$ is $-4$.
A convenient rule for evaluating reference expectation values is that the total excitation level of a closed graph must balance out to zero.
\end{dfn}

\begin{ex}
The excitation levels in the quasi-particle expansions of one- and two-particle operators are as follows.
\begin{align*}
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot=white] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
  \node at (0,-0.8) {$(0)$};
}
=&\
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot] (h1) {};
  \draw[->-] (h1) to ++(0,+0.5);
  \draw[-<-] (h1) to ++(0,-0.5);
  \node at (0,-0.8) {$(0)$};
}
+
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot] (h1) {};
  \draw[->-] (h1) to ++(-0.25,+0.5);
  \draw[-<-] (h1) to ++(+0.25,+0.5);
  \node at (0,-0.8) {$(+1)$};
}
+
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot] (h1) {};
  \draw[->-] (h1) to ++(-0.25,-0.5);
  \draw[-<-] (h1) to ++(+0.25,-0.5);
  \node at (0,-0.8) {$(-1)$};
}
+
\diagram{
  \draw (-0.5,0) node[circlep] (h) {} -- (0,0) node[ddot] (h1) {};
  \draw[->-] (h1) to ++(0,-0.5);
  \draw[-<-] (h1) to ++(0,+0.5);
  \node at (0,-0.8) {$(0)$};
}
\\[10pt]
\diagram{
  \interaction{2}{g}{(0,0)}{ddot=white}{sawtooth};
  \draw[->-] (g1) to ++(0,+0.5);
  \draw[-<-] (g1) to ++(0,-0.5);
  \draw[->-] (g2) to ++(0,+0.5);
  \draw[-<-] (g2) to ++(0,-0.5);
  \node at (0.5,-0.8) {$(0)$};
}
=&\
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(0,+0.5);
  \draw[-<-] (g1) to ++(0,-0.5);
  \draw[->-] (g2) to ++(0,+0.5);
  \draw[-<-] (g2) to ++(0,-0.5);
  \node at (0.5,-0.8) {$(0)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(0,+0.5);
  \draw[-<-] (g1) to ++(0,-0.5);
  \draw[->-] (g2) to ++(-0.25,+0.5);
  \draw[-<-] (g2) to ++(+0.25,+0.5);
  \node at (0.5,-0.8) {$(+1)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(0,+0.5);
  \draw[-<-] (g1) to ++(0,-0.5);
  \draw[->-] (g2) to ++(-0.25,-0.5);
  \draw[-<-] (g2) to ++(+0.25,-0.5);
  \node at (0.5,-0.8) {$(-1)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(-0.25,+0.5);
  \draw[-<-] (g1) to ++(+0.25,+0.5);
  \draw[->-] (g2) to ++(-0.25,+0.5);
  \draw[-<-] (g2) to ++(+0.25,+0.5);
  \node at (0.5,-0.8) {$(+2)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(-0.25,-0.5);
  \draw[-<-] (g1) to ++(+0.25,-0.5);
  \draw[->-] (g2) to ++(-0.25,+0.5);
  \draw[-<-] (g2) to ++(+0.25,+0.5);
  \node at (0.5,-0.8) {$(0)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(-0.25,-0.5);
  \draw[-<-] (g1) to ++(+0.25,-0.5);
  \draw[->-] (g2) to ++(-0.25,-0.5);
  \draw[-<-] (g2) to ++(+0.25,-0.5);
  \node at (0.5,-0.8) {$(-2)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(0,-0.5);
  \draw[-<-] (g1) to ++(0,+0.5);
  \draw[->-] (g2) to ++(-0.25,+0.5);
  \draw[-<-] (g2) to ++(+0.25,+0.5);
  \node at (0.5,-0.8) {$(+1)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(0,-0.5);
  \draw[-<-] (g1) to ++(0,+0.5);
  \draw[->-] (g2) to ++(-0.25,-0.5);
  \draw[-<-] (g2) to ++(+0.25,-0.5);
  \node at (0.5,-0.8) {$(-1)$};
}
+
\diagram{
  \interaction{2}{g}{(0,0)}{ddot}{sawtooth};
  \draw[->-] (g1) to ++(0,-0.5);
  \draw[-<-] (g1) to ++(0,+0.5);
  \draw[->-] (g2) to ++(0,-0.5);
  \draw[-<-] (g2) to ++(0,+0.5);
  \node at (0.5,-0.8) {$(0)$};
}\,\,.
\end{align*}
\end{ex}


\begin{ex}
\thmtitle{The CCSDT equations}
Truncating the cluster operator at triple excitations, $T\approx T_1 + T_2 + T_3$, leads to the CCSDT approximation.
The singles, doubles, and triples amplitude equations are given by the following
\begin{align}
  t_a^i
=&\
  (\mc{E}_a^i)^{-1}
  \ip{\F_i^a|
    V_\mr{c}
    (
      1
    +
      T_2
    +
      T_1
    +
      T_1T_2
    +
      \tfr{1}{2}
      T_1^2
    +
      \tfr{1}{3!}
      T_1^3
    +
      T_3
    )
  |\F}_\mr{C}
\\
  t_{ab}^{ij}
=&\
  (\mc{E}_{ab}^{ij})^{-1}
  \ip{\F_{ij}^{ab}|
    V_\mr{c}
    (
      1
    +
      T_2
    +
      \tfr{1}{2}
      T_2^2
    +
      T_1
    +
      T_1T_2
    +
      \tfr{1}{2}
      T_1^2
    +
      \tfr{1}{2}
      T_1^2T_2
    +
      \tfr{1}{3!}
      T_1^3
    +
      \tfr{1}{4!}
      T_1^4
    +
      T_3
    +
      T_1T_3
    )
  |\F}_\mr{C}
\\
  t_{abc}^{ijk}
=&\
  (\mc{E}_{abc}^{ijk})^{-1}
  \ip{\F_{ijk}^{abc}|
    V_\mr{c}
    (
      T_2
    +
      T_3
    +
      \tfr{1}{2}
      T_2^2
    +
      T_1T_2
    +
      T_2T_3
    +
      T_1T_3
    +
      \tfr{1}{2}
      T_1^2T_2
    +
      \tfr{1}{2}
      T_1T_2^2
    +
      \tfr{1}{2}
      T_1^2T_3
    +
      \tfr{1}{3!}
      T_1^3T_2
    )
  |\F}_\mr{C}
\end{align}
where several contributions to $\mr{exp}(T_1+T_2+T_3)$ have been omitted either because the excitation levels do not balance or because they require one of the cluster operators to be disconnected from the Hamiltonian.
\end{ex}



\newpage
\appendix
\section{Nested commutator relation}

\begin{prop}\label{prop:nested-commutator}
\thmtitle{Nested commutator relation}
\thmstatement{
$\ds{
  [X,\,\cdot\,]^n(Y)
=
  \sum_{k=0}^n
  (-)^k
  {n\choose k}
  X^{n-k}YX^k
}$.
}
\thmproof{
We proceed by induction on $n$.
For $n=1$ this follows from the definition of the commutator,
$
  [X,Y]
=
  XY
-
  YX
$.
Assuming the proposition holds for $n-1$ nested commutators, we can express the $n$-fold nested commutator as
\begin{align*}
  [X,\,\cdot\,]^n(Y)
=
  X[X,\,\cdot\,]^{n-1}(Y)
-
  [X,\,\cdot\,]^{n-1}(Y)\,X
=
  X^kY
+
  \sum_{k=1}^{n-1}
  (-)^k
  \pr{
    {n-1\choose k}
  +
    {n-1\choose k-1}
  }
  X^{n-k}YX^k
+
  (-)^nYX^n
\end{align*}
by expanding $[X,\,\cdot\,]^{n-1}(Y)$ twice and substituting $k$ for $k-1$ in the second summation.
Combining factorials as follows
\begin{align*}
  {n-1\choose k}
+
  {n-1\choose k-1}
=
  \fr{n-k}{n-k}\cdot
  \fr{(n-1)!}{k!(n-1-k)!}
+
  \fr{k}{k}\cdot
  \fr{(n-1)!}{(k-1)!(n-k)!}
=
  {n\choose k}
\end{align*}
shows that the proposition also holds for $n$, completing the proof by induction. 
}
\end{prop}


\end{document}